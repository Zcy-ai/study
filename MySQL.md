### 索引
索引是数据的目录
* 按「数据结构」分类：B+tree索引、Hash索引、Full-text索引
* 按「物理存储」分类：聚簇索引（主键索引）、二级索引（辅助索引）
* 按「字段特性」分类：主键索引、唯一索引、普通索引、前缀索引
* 按「字段个数」分类：单列索引、联合索引

InnoDB是MYSQL的默认存储引擎，B+Tree索引类型也是MySQL存储引擎采用最多的索引类型

如果有主键，默认会使用主键作为聚簇索引的索引键（key）
如果没有主键，就选择第一个不包含NULL值的唯一列作为聚簇索引的索引键（key）
在上面两个都没有的情况下，InnoDB将自动生成一个隐式自增id列作为聚簇索引的索引键
其它索引都属于辅助索引。创建的主键索引和二级索引默认使用的是B+Tree索引

B+Tree是一种多叉树，叶子节点才存放数据，非叶子节点只存放索引，而且每个节点里的数据是按主键顺序存放的。
每一层父节点的索引值都会出现在下层子节点的索引值中，因此在叶子节点中，包括了所有的索引值信息，并且每一个叶子节点都有两个指针，分别指向下一个叶子节点和上一个叶子节点，形成一个双向链表

B+Tree相比于B树和二叉树来说，最大的优势在于查询效率很高，因为即使数据量很大的情况，查询一个数据的磁盘I/O依然维持在3-4次

主键索引的B+Tree和二级索引的B+Tree：
* 主键索引的B+Tree的叶子节点存放的是实际数据，所有完整的用户记录都存放在主键索引的B+Tree的叶子节点里
* 二级索引的B+Tree的叶子节点存放的是主键值，而不是实际数据

二级索引B+Tree的检索过程：
通过二级索引值找到对应的叶子节点，然后获取主键值，然后再通过主键索引的B+Tree查询到对应的叶子节点，获取数据。这个过程叫做「回表」，也就是说要查两个B+Tree才能查到数据

覆盖索引：二级索引的B+Tree就能查询到结果，比如通过二级索引查主键值

### 为什么MySQL采用B+Tree作为索引
考虑磁盘I/O操作次数，因为MySQL的数据存储在磁盘中
索引的数据结构应满足的要求：
* 能在尽可能少的磁盘的I/O操作中完成查询
* 要能高效地查询某一个记录，也要能高效地执行范围查找

##### 二叉搜索树
二叉搜索树的特点是一个节点的左子树的所有节点都小于这个节点，右子树的所有节点都大于这个节点
缺点：
当每次插入的元素都是二叉查找树中最大的元素，二叉查找树就会退化成了一条链表，查找数据的时间复杂度变成了 O(n)
树的高度就等于每次查询数据时I/O操作的次数

##### 自平衡二叉树
每个节点的左子树和右子树的高度差不能超过 1
缺点：
不管平衡二叉查找树还是红黑树，都会随着插入的元素增多，而导致树的高度变高，这就意味着磁盘 I/O 操作次数多，会影响整体数据查询的效率

##### B树
B 树的每一个节点最多可以包括 M 个子节点，M 称为 B 树的阶，所以 B 树就是一个多叉树
每个节点最多有M-1个数据和最多有M个子节点

缺点：
* B 树的每个节点都包含数据（索引+记录），而用户的记录数据的大小很有可能远远超过了索引数据，这就需要花费更多的磁盘 I/O 操作次数来读到「有用的索引数据」。
* 在我们查询位于底层的某个节点（比如 A 记录）过程中，「非 A 记录节点」里的记录数据会从磁盘加载到内存，但是这些记录数据是没用的，我们只是想读取这些节点的索引数据来做比较查询，而「非 A 记录节点」里的记录数据对我们是没用的，这样不仅增多磁盘 I/O 操作次数，也占用内存资源。
* 如果使用 B 树来做范围查询的话，需要使用中序遍历，这会涉及多个节点的磁盘 I/O问题，从而导致整体速度下降。

##### B+Tree
* 叶子节点（最底部的节点）才会存放实际数据（索引+记录），非叶子节点只会存放索引；
* 所有索引都会在叶子节点出现，叶子节点之间构成一个有序链表；
* 非叶子节点的索引也会同时存在在子节点中，并且是在子节点中所有索引的最大（或最小）
* 非叶子节点中有多少个子节点，就有多少个索引；

1. 单点查询
B+ 树的非叶子节点不存放实际的记录数据，仅存放索引，因此数据量相同的情况下，相比存储即存索引又存记录的 B 树，B+树的非叶子节点可以存放更多的索引，因此 B+ 树可以比 B 树更「矮胖」，查询底层节点的磁盘 I/O次数会更少
2. 插入和删除效率
B+ 树由于存在冗余节点，不会发生复杂的树的变形，它的插入和删除效率更高
3. 范围查询
B+ 树所有叶子节点间还有一个链表进行连接，这种设计对范围查找非常有帮助

B+Tree vs Hash
Hash在做等值查询的时候效率高，复杂度为O（1）


按字段类型分类
主键索引：
一张表最多只有一个主键索引
唯一索引：
UNIQUE，一张表可以有多个唯一索引，索引列的值必须唯一，但是允许有空值
前缀索引：
前缀索引是指对字符类型字段的前几个字符建立的索引
```sql
CREATE TABLE table_name(
    column_list,
    INDEX(column_name(length))
);
```

